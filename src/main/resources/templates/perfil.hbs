<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/header.css">
    <link rel="stylesheet" href="css/login.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <link rel="stylesheet" href="css/estiloGeneral.css">
    <link rel="stylesheet" href="css/perfilPersona.css">

    <meta charset="utf-8">
    <title>Editar Perfil Persona</title>
</head>

<body class="bodyInterno centrado">

<!-- HEADER -->
<header>
    <div class="menu-container" style="margin: auto 0;">
        <ul class="menu" style="margin-left: 40px;">
            <li><a href="/inicio">Inicio</a></li>
            <li class="paginaActual"> <a href="/perfil"> Configuración </a></li>
            <li><a href="/incidentes">Incidentes</a></li>
            <li ><a href="/comunidades">Comunidades</a></li>
            <li ><a href="/rankings">Ranking</a></li>
        </ul>

        <img src="img/logo.png" alt="logo-header">
    </div>
</header>

<div class="sostenedor_de_campos">
    <form method="POST" action="/perfil">
    <div class="campo" data-campo="nombre">
        <label for="nombre">Nombre:</label>
        <div class="campo-editable">

                <input type="nombre" class="input-text" name="nombre" value="{{persona.usuario.nombre}}" id="nombre" >
            <button class="edit-button lapiz"><i class="fas fa-pencil-alt"></i></button>
            <button class="save-button boton guardar" onclick="guardarCampo('nombre')">Guardar</button>
        </div>
    </div>

    <div class="campo" data-campo="email">
        <label for="email">Email:</label>
        <div class="campo-editable">

                <input type="email" class="input-text"name="email" value="{{persona.email}}" id="email" >
            <button class="edit-button lapiz"><i class="fas fa-pencil-alt"></i></button>
            <button class="save-button boton guardar" onclick="guardarCampo('email')">Guardar</button>

        </div>
    </div>

    <div class="campo" data-campo="telefono">
        <label for="telefono">Teléfono:</label>
        <div class="campo-editable">
                <input type="telefono" class="input-text"name="telefono" value="{{persona.telefono}}" id="telefono" >
            <button class="edit-button lapiz"><i class="fas fa-pencil-alt"></i></button>
            <button class="save-button boton guardar" onclick="guardarCampo('telefono')">Guardar</button>
        </div>

    </div>

        <div class="campo" data-campo="localidad">
            <label for="localidad">Localidad:</label>
            <div class="campo-editable">
                <select class="input-select" name="localidad" id="localidad">
                    {{#each localidades}}
                        <option value="{{this.id}}">{{this.nombre}}</option>
                    {{/each}}
                </select>
                <button class="secondary-button boton guardar" data-always-visible="true" onclick="guardarCampo('localidad')">Guardar</button>
            </div>
        </div>

    </form>

</div>

<div class="sostenedor_de_botones">
    <p>Elige la forma de recibir notificaciones</p>
    <div class="grupo" id="grupo1">
        <button class="boton_seleccionador" data-campo="medioNotificacion" data-valor="WHATSAPP">Telefono</button>
        <button class="boton_seleccionador" data-campo="medioNotificacion" data-valor="EMAIL">Email</button>
    </div>
    <div class="grupo" id="grupo2">
        <button class="boton_seleccionador" data-campo="frecuenciaNotificacion" data-valor="CUANDO_SUCEDE">Cuando sucede</button>
        <button class="boton_seleccionador" data-campo="frecuenciaNotificacion" data-valor="SIN_APURO">Sin apuros</button>
    </div>

    <p style="margin-top: 25px;" id="parrafo">Horarios para recibir notificaciones sin apuros</p>
    <div class="horarios-container">
        <div class="horarios-seleccionados"></div>
        <button class="add-btn" onclick="toggleDropdown()">
            +
            <div class="dropdown">
                <div class="dropdown-content" id="dropdown-content">

                </div>
            </div>
        </button>
        <button onclick="guardarHorarios() " class="botonsote">Guardar</button>
    </div>
<li class = "cerrarSesion"> <a href="/logout">Cerrar Sesión</a></li>
</div>


<button onclick="guardarHorarios() " class="botonsote alineacion"><a href="/carga-masiva">Carga Masiva</a></button>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="js/editarPerfil.js"></script>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const preferenciaMedioNotificacion = "{{persona.preferenciaMedioNotificacion}}";

        console.log('preferenciaMedioNotificacion:', preferenciaMedioNotificacion);

        let botonMedioNotificacion = document.querySelector(`#grupo1 .boton_seleccionador[data-valor="${preferenciaMedioNotificacion}"]`);
        if (botonMedioNotificacion) {
            botonMedioNotificacion.click();
        }

    });
</script>




</body>
</html>